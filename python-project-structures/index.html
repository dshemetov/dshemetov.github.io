<!doctype html><html lang=en-us><head><meta http-equiv=x-clacks-overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Python Project Structures | ┐｜･ิω･ิ#｜┌ Dmitry's Online Webpage</title><meta name=title content="Python Project Structures"><meta name=description content="Updated on: 2023-07-24.
Python project structures are confusing. Let&rsquo;s make them less so.
Terminology First, a few standard Python terminology definitions:
a module is a single Python script, a package is a collection of modules1. A project may be an application or a library:
an application is a program that is meant to be deployed, such as a script for numerical calculations, a server, or a Discord bot, a library is a package that will be imported by other libraries or applications."><meta name=keywords content="python,"><meta property="og:title" content="Python Project Structures"><meta property="og:description" content="Updated on: 2023-07-24.
Python project structures are confusing. Let&rsquo;s make them less so.
Terminology First, a few standard Python terminology definitions:
a module is a single Python script, a package is a collection of modules1. A project may be an application or a library:
an application is a program that is meant to be deployed, such as a script for numerical calculations, a server, or a Discord bot, a library is a package that will be imported by other libraries or applications."><meta property="og:type" content="article"><meta property="og:url" content="https://dshemetov.github.io/python-project-structures/"><meta property="og:image" content="https://dshemetov.github.io/images/math-dmitry.jpg"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-09-02T17:29:37-07:00"><meta property="article:modified_time" content="2022-09-02T17:29:37-07:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://dshemetov.github.io/images/math-dmitry.jpg"><meta name=twitter:title content="Python Project Structures"><meta name=twitter:description content="Updated on: 2023-07-24.
Python project structures are confusing. Let&rsquo;s make them less so.
Terminology First, a few standard Python terminology definitions:
a module is a single Python script, a package is a collection of modules1. A project may be an application or a library:
an application is a program that is meant to be deployed, such as a script for numerical calculations, a server, or a Discord bot, a library is a package that will be imported by other libraries or applications."><meta itemprop=name content="Python Project Structures"><meta itemprop=description content="Updated on: 2023-07-24.
Python project structures are confusing. Let&rsquo;s make them less so.
Terminology First, a few standard Python terminology definitions:
a module is a single Python script, a package is a collection of modules1. A project may be an application or a library:
an application is a program that is meant to be deployed, such as a script for numerical calculations, a server, or a Discord bot, a library is a package that will be imported by other libraries or applications."><meta itemprop=datePublished content="2022-09-02T17:29:37-07:00"><meta itemprop=dateModified content="2022-09-02T17:29:37-07:00"><meta itemprop=wordCount content="591"><meta itemprop=image content="https://dshemetov.github.io/images/math-dmitry.jpg"><meta itemprop=keywords content="python,"><meta name=referrer content="no-referrer-when-downgrade"><style>body{font-family:Verdana,sans-serif;margin:auto;padding:20px;max-width:720px;text-align:left;background-color:#fff;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}a{color:#3273dc}.title{text-decoration:none;border:0}.title span{font-weight:400}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}pre code{color:#222;display:block;padding:20px;white-space:pre-wrap;font-size:14px;overflow-x:auto}div.highlight pre{background-color:initial;color:initial}div.highlight code{background-color:unset;color:unset}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}footer{padding:25px;text-align:center}.helptext{color:#777;font-size:small}.errorlist{color:#eba613;font-size:small}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#333;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#777}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}.helptext{color:#aaa}}</style><script>MathJax={loader:{load:["[tex]/mathtools"]},tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0,macros:{R:"{\\mathbb R}",Z:"{\\mathbb Z}",C:"{\\mathbb C}"},packages:{"[+]":["mathtools"]}},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><style type=text/css>@media(prefers-color-scheme:dark){body{background-color:#1a2638}code{background-color:#222;color:#eba613}}a{text-decoration:none}a:hover{text-decoration:underline}ol li{counter-increment:listCounter}ol li::marker{content:'(' counter(listCounter)").  "}figure{text-align:center;font-style:italic;font-size:smaller;text-indent:0;display:block;margin-left:auto;margin-right:auto;max-width:75%}figure.left{float:left;margin-right:2em;max-width:75%}figure.right{float:right;margin-left:2em;max-width:75%}@media(max-width:800px){figure.left,figure.right{float:none;margin-top:2em;margin-bottom:2em;margin-right:2em;margin-left:2em;max-width:50%}}.common-footer{margin-top:1em;padding-top:1em}.content{margin-top:1em}code.has-jax{-webkit-font-smoothing:antialiased;background:inherit!important;border:none!important;font-size:100%}</style><meta property="og:type" content="website"><meta property="og:url" content><meta property="og:title" content><meta property="og:description" content><meta property="og:image" content><meta name=description content="Updated on: 2023-07-24.
Python project structures are confusing. Let&rsquo;s make them less so.
Terminology First, a few standard Python terminology definitions:
a module is a single Python script, a package is a collection of modules1. A project may be an application or a library:
an application is a program that is meant to be deployed, such as a script for numerical calculations, a server, or a Discord bot, a library is a package that will be imported by other libraries or applications."></head><body><header><a href=/ class=title><h2>┐｜･ิω･ิ#｜┌ Dmitry's Online Webpage</h2></a><nav><a href=/>Home</a>
<a href=/projects/>Projects</a>
<a href=/blog>Blog</a></nav></header><main><h1>Python Project Structures</h1><p><i><time datetime=2022-09-02 pubdate>02 Sep, 2022</time></i></p><aside><h1>Table of Contents</h1><nav id=TableOfContents><ul><li><a href=#terminology>Terminology</a></li><li><a href=#project-structures>Project Structures</a></li><li><a href=#imports>Imports</a></li><li><a href=#managing-pythons-dependencies-and-environments>Managing Pythons, Dependencies, and Environments</a></li><li><a href=#footnotes>Footnotes</a></li></ul></nav></aside><content><p>Updated on: 2023-07-24.</p><p>Python project structures are confusing. Let&rsquo;s make them less so.</p><h2 id=terminology>Terminology</h2><p>First, a few standard Python terminology definitions:</p><ul><li>a <strong>module</strong> is a single Python script,</li><li>a <strong>package</strong> is a collection of modules<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</li></ul><p>A project may be an application or a library:</p><ul><li>an <strong>application</strong> is a program that is meant to be deployed, such as a script for numerical calculations, a server, or a Discord bot,</li><li>a <strong>library</strong> is a package that will be imported by other libraries or applications.</li></ul><h2 id=project-structures>Project Structures</h2><p>There are a few common, recommended Python project structures<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>. This is the one I prefer:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>project_root/
</span></span><span style=display:flex><span>    docs/
</span></span><span style=display:flex><span>        conf.py
</span></span><span style=display:flex><span>        index.md
</span></span><span style=display:flex><span>    package/
</span></span><span style=display:flex><span>        __init__.py
</span></span><span style=display:flex><span>        subpackageA/
</span></span><span style=display:flex><span>            __init__.py
</span></span><span style=display:flex><span>            moduleA.py
</span></span><span style=display:flex><span>        module.py
</span></span><span style=display:flex><span>    tests/
</span></span><span style=display:flex><span>        __init__.py
</span></span><span style=display:flex><span>        test_module.py
</span></span><span style=display:flex><span>    requirements.txt
</span></span><span style=display:flex><span>    runner.py
</span></span><span style=display:flex><span>    README.md
</span></span><span style=display:flex><span>    LICENSE
</span></span><span style=display:flex><span>    pyproject.toml
</span></span></code></pre></div><p>It separates tests from the package code and removes the unnecessary <code>src</code> folder.</p><ul><li>The <code>runner.py</code> script is the entry point for the application, such as a CLI (if you&rsquo;re building a library, you can omit this file).</li><li>The <code>package</code> folder is the package that will be imported by other libraries or applications.</li><li>The <code>tests</code> folder contains unit tests for the package.</li><li>The <code>docs</code> folder contains documentation for the package.</li></ul><p>The application is run with <code>python runner.py</code> from the top-level directory.</p><h2 id=imports>Imports</h2><p>Imports in each file can be handled as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># absolute import in runner.py</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> package <span style=color:#f92672>import</span> module
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># absolute import in package/module.py</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> package.subpackageA <span style=color:#f92672>import</span> moduleA
</span></span><span style=display:flex><span><span style=color:#75715e># relative import in package/module.py</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> .subpackageA <span style=color:#f92672>import</span> moduleA
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># absolute import in package/subpackageA/moduleA.py</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> package <span style=color:#f92672>import</span> module
</span></span><span style=display:flex><span><span style=color:#75715e># relative import in package/subpackageA/moduleA.py</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> .. <span style=color:#f92672>import</span> module
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># absolute import in tests/test_module.py</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> package <span style=color:#f92672>import</span> module
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> package.subpackageA <span style=color:#f92672>import</span> moduleA
</span></span></code></pre></div><p>Note that scripts can&rsquo;t import relative to each other, so you can&rsquo;t do <code>from . import module</code> in <code>runner.py</code> (this is because the <code>__name__</code> variable for <code>runner.py</code> is <code>__main__</code> when run as <code>python runner.py</code> and therefore Python can&rsquo;t do module name manipulation, see more <a href=https://stackoverflow.com/questions/14132789/relative-imports-for-the-billionth-time>here</a>).</p><p>If you run <code>python runner.py</code> from the top-level directory, the <code>project_root</code> will be in your <code>PYTHONPATH</code> environment variable, so you can import <code>package</code> and its submodules from anywhere in the project.
If you run <code>python package/module.py</code> from the top-level directory, you will get an error because <code>PYTHONPATH</code> will not contain <code>project_root</code>.
You can test this by showing the Python path in <code>runner.py</code> and <code>package/module.py</code> (via the <a href="https://docs.python.org/3/library/sys.html?highlight=sys%20path#sys.path"><code>sys.path</code> variable</a>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># runner.py</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span>print(sys<span style=color:#f92672>.</span>path)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># package/module.py</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span>print(sys<span style=color:#f92672>.</span>path)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># output of `python runner.py`:</span>
</span></span><span style=display:flex><span>[<span style=color:#e6db74>&#39;/path/to/project_root&#39;</span>, <span style=color:#f92672>...</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># output of `python package/module.py`:</span>
</span></span><span style=display:flex><span>[<span style=color:#e6db74>&#39;/path/to/project_root/package&#39;</span>, <span style=color:#f92672>...</span>]
</span></span></code></pre></div><p>Alternatively, you can run a package script from the top-level directory by using <code>-m</code> flag (see more on the <a href=https://docs.python.org/3/using/cmdline.html#cmdoption-m>-m flag here</a>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>python -m package.module
</span></span></code></pre></div><p>For testing, <code>pytest .</code> should work from any directory<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>.</p><h2 id=managing-pythons-dependencies-and-environments>Managing Pythons, Dependencies, and Environments</h2><p>When it comes to Python management, I like to keep it simple.
I <a href=https://github.com/pyenv/pyenv>use <code>pyenv</code></a> to manage Python versions and <code>python -m venv venv</code> to create virtual environments in my project.
My standard <code>requirements.txt</code> file looks like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>black
</span></span><span style=display:flex><span>ruff
</span></span><span style=display:flex><span>pytest
</span></span><span style=display:flex><span>typer[all]
</span></span></code></pre></div><ul><li><a href=https://black.readthedocs.io/en/stable/><code>black</code> is a code formatter</a>,</li><li><a href=https://beta.ruff.rs/docs/><code>ruff</code> is a linter</a>,</li><li><a href=https://docs.pytest.org/><code>pytest</code> is a testing framework</a>,</li><li><a href=https://typer.tiangolo.com/typer-cli/><code>typer</code> is a CLI framework</a>.</li></ul><p>The modern place to store tool configuration settings is <code>pyproject.toml</code>. <a href=https://gist.github.com/dshemetov/30001cf62798c3b749cbb26bd977946b>Here</a> is a sample <code>pyproject.toml</code> I use for my projects.
(See <a href=https://snarky.ca/what-the-heck-is-pyproject-toml/>here</a> for an introductory blog post by Brett Cannon, one of the authors of <a href=https://peps.python.org/pep-0518/>PEP-518</a> and <a href=https://peps.python.org/pep-0621/>PEP-621</a>.)</p><h2 id=footnotes>Footnotes</h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://docs.python.org/3/reference/import.html#packages>These definitions are 90% true</a>.
Package is an <a href=https://stackoverflow.com/a/54599368/4784655>overloaded term in Python</a>.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>This structure is recommended by the popular <a href=https://docs.python-guide.org/writing/structure/>Hitchhiker&rsquo;s Guide to Python</a>.
It is also default for <a href=https://github.com/python-poetry/poetry><code>poetry</code> projects</a>, a common Python workflow tool.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><code>pytest</code> will find your project root by traversing up the directory hierarchy, see <a href=https://docs.pytest.org/en/7.1.x/explanation/pythonpath.html#test-modules-conftest-py-files-inside-packages>more here</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></content><p><a href=https://dshemetov.github.io/blog/python/>#python</a></p></main><footer>Made with <a href=https://github.com/janraasch/hugo-bearblog/>Hugo ʕ•ᴥ•ʔ Bear</a></footer></body></html>