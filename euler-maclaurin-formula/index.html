<!doctype html><html lang=en-us><head><meta http-equiv=X-Clacks-Overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Euler-Maclaurin Formula | Dmitry's Very Online Internet Webpage Site</title><meta name=title content="Euler-Maclaurin Formula"><meta name=description content="In the math test post, we briefly discussed how to arrive at Stirling&rsquo;s approximation.
Here, we go deeper.
Asymptotic Behavior of the Harmonic Series
Let&rsquo;s begin by understanding the asymptotic behavior of the harmonic series.
The harmonic series $H_n = \sum_{i=1}^n \frac 1 i$ can be estimated with an integral
$$
    \sum_{i=1}^n \frac 1 i \approx \int_1^n \frac 1 x dx = \ln n,
$$with
$$
    \lim_{n \to \infty} (H_n - \ln n) = \gamma,
$$where $\gamma$ ~ 0.57&mldr; is the Euler-Mascherroni constant."><meta name=keywords content="math,asymptotics,"><meta property="og:url" content="https://dshemetov.github.io/euler-maclaurin-formula/"><meta property="og:site_name" content="Dmitry's Very Online Internet Webpage Site"><meta property="og:title" content="Euler-Maclaurin Formula"><meta property="og:description" content="In the math test post, we briefly discussed how to arrive at Stirling’s approximation. Here, we go deeper.
Asymptotic Behavior of the Harmonic Series Let’s begin by understanding the asymptotic behavior of the harmonic series. The harmonic series $H_n = \sum_{i=1}^n \frac 1 i$ can be estimated with an integral
$$ \sum_{i=1}^n \frac 1 i \approx \int_1^n \frac 1 x dx = \ln n, $$with
$$ \lim_{n \to \infty} (H_n - \ln n) = \gamma, $$where $\gamma$ ~ 0.57… is the Euler-Mascherroni constant."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-08-31T09:58:27-07:00"><meta property="article:modified_time" content="2022-08-31T09:58:27-07:00"><meta property="article:tag" content="Math"><meta property="article:tag" content="Asymptotics"><meta name=twitter:card content="summary"><meta name=twitter:title content="Euler-Maclaurin Formula"><meta name=twitter:description content="In the math test post, we briefly discussed how to arrive at Stirling’s approximation. Here, we go deeper.
Asymptotic Behavior of the Harmonic Series Let’s begin by understanding the asymptotic behavior of the harmonic series. The harmonic series $H_n = \sum_{i=1}^n \frac 1 i$ can be estimated with an integral
$$ \sum_{i=1}^n \frac 1 i \approx \int_1^n \frac 1 x dx = \ln n, $$with
$$ \lim_{n \to \infty} (H_n - \ln n) = \gamma, $$where $\gamma$ ~ 0.57… is the Euler-Mascherroni constant."><meta itemprop=name content="Euler-Maclaurin Formula"><meta itemprop=description content="In the math test post, we briefly discussed how to arrive at Stirling’s approximation. Here, we go deeper.
Asymptotic Behavior of the Harmonic Series Let’s begin by understanding the asymptotic behavior of the harmonic series. The harmonic series $H_n = \sum_{i=1}^n \frac 1 i$ can be estimated with an integral
$$ \sum_{i=1}^n \frac 1 i \approx \int_1^n \frac 1 x dx = \ln n, $$with
$$ \lim_{n \to \infty} (H_n - \ln n) = \gamma, $$where $\gamma$ ~ 0.57… is the Euler-Mascherroni constant."><meta itemprop=datePublished content="2022-08-31T09:58:27-07:00"><meta itemprop=dateModified content="2022-08-31T09:58:27-07:00"><meta itemprop=wordCount content="471"><meta itemprop=keywords content="Math,Asymptotics"><meta name=referrer content="no-referrer-when-downgrade"><style>:root{--width:720px;--font-main:Verdana, sans-serif;--font-secondary:Verdana, sans-serif;--font-scale:1em;--background-color:#fff;--heading-color:#222;--text-color:#444;--link-color:#3273dc;--visited-color:#8b6fcb;--blockquote-color:#222}@media(prefers-color-scheme:dark){:root{--background-color:#01242e;--heading-color:#eee;--text-color:#ddd;--link-color:#8cc2dd;--visited-color:#8b6fcb;--blockquote-color:#ccc}}body{font-family:var(--font-secondary);font-size:var(--font-scale);margin:auto;padding:20px;max-width:var(--width);text-align:left;background-color:var(--background-color);word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:var(--text-color)}h1,h2,h3,h4,h5,h6{font-family:var(--font-main);color:var(--heading-color)}a{color:var(--link-color);cursor:pointer;text-decoration:none}a:hover{text-decoration:underline}nav a{margin-right:8px}strong,b{color:var(--heading-color)}button{margin:0;cursor:pointer}time{font-family:monospace;font-style:normal;font-size:15px}main{line-height:1.6}table{width:100%}hr{border:0;border-top:1px dashed}img{max-width:100%}code{font-family:monospace;padding:2px;border-radius:3px}blockquote{border-left:1px solid #999;color:var(--blockquote-color);padding-left:20px;font-style:italic}footer{padding:25px 0;text-align:center}.title:hover{text-decoration:none}.title h1{font-size:1.5em}.inline{width:auto!important}.highlight,.code{border-radius:3px;margin-block-start:1em;margin-block-end:1em;overflow-x:auto}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:var(--visited-color)}</style><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script>MathJax={loader:{load:["[tex]/mathtools"]},tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0,macros:{R:"{\\mathbb R}",Z:"{\\mathbb Z}",C:"{\\mathbb C}"},packages:{"[+]":["mathtools"]}},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><style type=text/css>@media(prefers-color-scheme:dark){body{background-color:#1a2638}code{background-color:#222;color:#eba613}}a{text-decoration:none}a:hover{text-decoration:underline}ol li{counter-increment:listCounter}ol li::marker{content:'(' counter(listCounter)").  "}figure{text-align:center;font-style:italic;font-size:smaller;text-indent:0;display:block;margin-left:auto;margin-right:auto;max-width:75%}figure.left{float:left;margin-right:2em;max-width:75%}figure.right{float:right;margin-left:2em;max-width:75%}@media(max-width:800px){figure.left,figure.right{float:none;margin-top:2em;margin-bottom:2em;margin-right:2em;margin-left:2em;max-width:50%}}.common-footer{margin-top:1em;padding-top:1em}.content{margin-top:1em}code.has-jax{-webkit-font-smoothing:antialiased;background:inherit!important;border:none!important;font-size:100%}</style><meta property="og:type" content="website"><meta property="og:url" content><meta property="og:title" content><meta property="og:description" content><meta property="og:image" content><meta name=description content="In the math test post, we briefly discussed how to arrive at Stirling&rsquo;s approximation.
Here, we go deeper.
Asymptotic Behavior of the Harmonic Series
Let&rsquo;s begin by understanding the asymptotic behavior of the harmonic series.
The harmonic series $H_n = \sum_{i=1}^n \frac 1 i$ can be estimated with an integral
$$
    \sum_{i=1}^n \frac 1 i \approx \int_1^n \frac 1 x dx = \ln n,
$$with
$$
    \lim_{n \to \infty} (H_n - \ln n) = \gamma,
$$where $\gamma$ ~ 0.57&mldr; is the Euler-Mascherroni constant."></head><body><header><a href=/ class=title><h2>Dmitry's Very Online Internet Webpage Site</h2></a><nav><a href=/>Home</a>
<a href=/now/>Now</a>
<a href=/projects/>Projects</a>
<a href=/blog/>Blog</a></nav></header><main><h1>Euler-Maclaurin Formula</h1><p><i><time datetime=2022-08-31>2022-08-31</time></i></p><aside><h1>Table of Contents</h1><nav id=TableOfContents><ul><li><a href=#asymptotic-behavior-of-the-harmonic-series>Asymptotic Behavior of the Harmonic Series</a></li><li><a href=#euler-maclaurin-formula>Euler-Maclaurin Formula</a><ul><li><a href=#bernoulli-numbers>Bernoulli Numbers</a></li><li><a href=#bernoulli-polynomials>Bernoulli Polynomials</a></li><li><a href=#low-order-terms-of-the-euler-maclaurin-formula>Low-Order Terms of the Euler-Maclaurin Formula</a></li><li><a href=#darboux-formula>Darboux Formula</a></li></ul></li><li><a href=#references>References</a></li></ul></nav></aside><content><p>In the <a href=/blog/binomial-poisson>math test post</a>, we briefly discussed how to arrive at Stirling&rsquo;s approximation.
Here, we go deeper.</p><h2 id=asymptotic-behavior-of-the-harmonic-series>Asymptotic Behavior of the Harmonic Series</h2><p>Let&rsquo;s begin by understanding the asymptotic behavior of the harmonic series.
The harmonic series $H_n = \sum_{i=1}^n \frac 1 i$ can be estimated with an integral</p>$$
\sum_{i=1}^n \frac 1 i \approx \int_1^n \frac 1 x dx = \ln n,
$$<p>with</p>$$
\lim_{n \to \infty} (H_n - \ln n) = \gamma,
$$<p>where $\gamma$ ~ 0.57&mldr; is the <a href=https://en.wikipedia.org/wiki/Euler%27s_constant>Euler-Mascherroni constant</a>.</p><h2 id=euler-maclaurin-formula>Euler-Maclaurin Formula</h2><p>We can get even more terms in this approximation with the <a href=https://en.wikipedia.org/wiki/Euler%E2%80%93Maclaurin_formula>Euler-Maclaurin formula</a>.
Let&rsquo;s look at the details of this formula.
Suppose we have a function $f: \R \to \R$ that is continuously differentiable $p$ many times on $[n, m]$.
Defining the quantities
\begin{align*}
S & = \sum_{i=n}^m f(i) \\
I & = \int_n^m f(x) dx,
\end{align*}
we have</p>$$
S - I = \sum_{k=1}^p \frac{B_k}{k!} \left( f^{(k-1)}(m) - f^{(k-1)}(n) \right) + R_p,
$$<p>where $B_k$ is the $k$th Bernoulli number (with $B_1 = \frac 1 2$) and $R_p$ is an error term depending on $n, m, f$, and $p$.</p><h3 id=bernoulli-numbers>Bernoulli Numbers</h3><p><a href=https://en.wikipedia.org/wiki/Bernoulli_number>Bernoulli numbers</a> arise in many places.
An explicit definition is</p>$$
B_n = \sum_{k=0}^n \sum_{v=0}^k (-1)^v {k \choose v} \frac{(v+1)^n}{k+1}.
$$<p>A recursive definition is</p>$$
B_n = 1 - \sum_{k=}^{n-1} {n \choose k} \frac{B_k} {m - k +1}.
$$<p>A few terms of this sequence are</p>$$
1, \frac 1 2, \frac 1 6, 0, -\frac 1{30}, 0, \frac 1 {42}, 0, \dots .
$$<p>Indeed, all the odd terms larger than 1 are zero.</p><p>The error term $R_p$ can be expressed as an integral of the periodized Bernoulli polynomials $P_k(x) \coloneqq B_k(x - \lfloor x \rfloor)$,</p>$$
R_p = (-1)^{p+1} \int_n^m f^{(p)}(x) \frac{P_p(x)}{p!} dx.
$$<h3 id=bernoulli-polynomials>Bernoulli Polynomials</h3><p>The <a href=https://en.wikipedia.org/wiki/Bernoulli_polynomials>Bernoulli polynomials</a> $B_k(x)$, in turn, are defined recursively via
\begin{align*}
B'_k(x) & = k B_{k-1}(x), \\
\int_0^1 B_k(x) dx & = 0.
\end{align*}
An explicit formula is</p>$$
B_n(x) = \sum_{i=0}^n \frac 1 {i+1} \sum_{k=0}^i (-1)^k {i \choose k} (x+k)^n.
$$<h3 id=low-order-terms-of-the-euler-maclaurin-formula>Low-Order Terms of the Euler-Maclaurin Formula</h3><p>Returning to the Euler-Maclaurin formula, we can write out a few low order terms
\begin{align*}
\sum_{i=n}^m f(i) & = \int_n^m f(x) dx + \frac{f(n) + f(m)}2 + \int_n^m f'(x) P_1(x) dx \\
& = \int_n^m f(x) dx + \frac{f(n) + f(m)}2 + \frac 1 6 \frac{f'(m) - f'(n)}{2!} - \int_n^m f''(x) \frac{P_2(x)}{2!} dx \\
& = \int_n^m f(x) dx + \frac{f(n) + f(m)}2 + \frac 1 6 \frac{f'(m) - f'(n)}{2!} + \int_n^m f'''(x) \frac{P_3(x)}{3!} dx.
\end{align*}</p><h3 id=darboux-formula>Darboux Formula</h3><p>The <a href=https://mathworld.wolfram.com/DarbouxsFormula.html>Darboux formula</a> seems like a neat generalization that unites Euler-Maclaurin and Taylor series and can be proved via integration by parts, but it&rsquo;s quickly getting too abstract for me.</p><h2 id=references>References</h2><ul><li>And see a fuller derivation <a href="https://math.stackexchange.com/questions/352733/reference-for-proof-of-harmonic-number-asymptotic-expansion?rq=1">here</a>.</li><li><a href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.384.3289&amp;rep=rep1&amp;type=pdf"><em>An Elementary View of Euler&rsquo;s Summation Formula</em>, Apostol, T.</a> (PDF link)</li><li><a href="https://www.google.com/books/edition/Concrete_Mathematics/cjgPAQAAMAAJ?hl=en"><em>Concrete Mathematics</em>, Graham, Knuth, Patashnik</a> (<a href=https://www.csie.ntu.edu.tw/~r97002/temp/Concrete%20Mathematics%202e.pdf>PDF link</a>)</li></ul></content><p><a href=https://dshemetov.github.io/blog/math/>#Math</a>
<a href=https://dshemetov.github.io/blog/asymptotics/>#Asymptotics</a></p></main><footer>Made with <a href=https://github.com/janraasch/hugo-bearblog/>Hugo ʕ•ᴥ•ʔ Bear</a></footer></body></html>